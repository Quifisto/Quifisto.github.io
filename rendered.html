<!DOCTYPE html>
<html lang="nl">
<head>
    <title>'Skek bestellijst</title>
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/images/icons/apple-touch.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">

    <style>
      #table-container {
        width: fit-content;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      h3 {
        width: 100%;
        text-align: left;
        text-decoration: underline;
      }

      table {
        padding: 30px;
      }

    </style>

</head>
<body>

<h1>Bestellijst</h1>
<ol>
    <li>Vul eerst de mep in.</li>
    <li>Check vervolgens per categorie gesorteerd hoeveel er overal nog van is.</li>
    <li>Daarna wordt in de juiste volgorde een bestellijst voor je gemaakt</li>
    <li>Enjoy!</li>
</ol>

<div id="table-container">
<!-- Misschien form en dan na elke stap een post request zodat alles in python opgeteld kan worden, hoef ik niet hald in javascript te programmeren?
     Of misschien juist wel zodat het ook offline kan.-->
<h3>Mep</h3>
<table id="mep">
  <thead>
    <tr>
      <th>Recept</th>
      <th>Hoeveelheid</th>
    </tr>
  </thead>
  <tbody>
  
   <tr class=amuse>
       <td> amuse </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=aubergine tempura>
       <td> aubergine tempura </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=aubergine>
       <td> aubergine </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=bananenbrood>
       <td> bananenbrood </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=bediening>
       <td> bediening </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=champignons>
       <td> champignons </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=feta>
       <td> feta </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=friet>
       <td> friet </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=garnering>
       <td> garnering </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=gekarameliseerde ui>
       <td> gekarameliseerde ui </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=harissa>
       <td> harissa </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=jackfruit>
       <td> jackfruit </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=kashke>
       <td> kashke </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=knolselderij>
       <td> knolselderij </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=koolsla>
       <td> koolsla </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=kruidenboter>
       <td> kruidenboter </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=nuggets>
       <td> nuggets </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=oesterzwam>
       <td> oesterzwam </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=pastei>
       <td> pastei </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=peterselieboter>
       <td> peterselieboter </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=pruimenglaze>
       <td> pruimenglaze </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=salsa>
       <td> salsa </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=shakshuka>
       <td> shakshuka </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=sjalot>
       <td> sjalot </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=tiramisu>
       <td> tiramisu </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=topping>
       <td> topping </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
   <tr class=wortel>
       <td> wortel </td>
       <td> <input type="number" value=0> </td>
   </tr>
  
  </tbody>
</table>



<h3>Voorraad</h3>
<table id="voorraad">
  <thead>
    <tr>
      <th>Plek</th>
      <th>Ingredient</th>
      <th>Hoeveelheid</th>
    </tr>
  </thead>
  <tbody>
  
   <tr> <th>kast fruit</th></tr>
   
   <tr class=sinaasappel>
      <td></td>
       <td> sinaasappel </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=pruim>
      <td></td>
       <td> pruim </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=limoen>
      <td></td>
       <td> limoen </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=citroen>
      <td></td>
       <td> citroen </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=mandarijn>
      <td></td>
       <td> mandarijn </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=granaatappel>
      <td></td>
       <td> granaatappel </td>
       <td> <input type="number" value=0>  st </td>
   </tr>
   
   <tr class=peer>
      <td></td>
       <td> peer </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
  
   <tr> <th>kast groenten</th></tr>
   
   <tr class=knolselderij>
      <td></td>
       <td> knolselderij </td>
       <td> <input type="number" value=0>  st </td>
   </tr>
   
   <tr class=aardappel>
      <td></td>
       <td> aardappel </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=tomaat>
      <td></td>
       <td> tomaat </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=aubergine>
      <td></td>
       <td> aubergine </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
  
   <tr> <th>kast kruiden</th></tr>
   
   <tr class=rode ui>
      <td></td>
       <td> rode ui </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=ui>
      <td></td>
       <td> ui </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=sjalot>
      <td></td>
       <td> sjalot </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=gember>
      <td></td>
       <td> gember </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=knoflook>
      <td></td>
       <td> knoflook </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
  
   <tr> <th>koeling groenten</th></tr>
   
   <tr class=wortel>
      <td></td>
       <td> wortel </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=oesterzwam>
      <td></td>
       <td> oesterzwam </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=champignon>
      <td></td>
       <td> champignon </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=sla>
      <td></td>
       <td> sla </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=rucola>
      <td></td>
       <td> rucola </td>
       <td> <input type="number" value=0>  bakje </td>
   </tr>
   
   <tr class=rode peper>
      <td></td>
       <td> rode peper </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=paprika>
      <td></td>
       <td> paprika </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=komkommer>
      <td></td>
       <td> komkommer </td>
       <td> <input type="number" value=0>  st </td>
   </tr>
   
   <tr class=bloemkool>
      <td></td>
       <td> bloemkool </td>
       <td> <input type="number" value=0>  st </td>
   </tr>
   
   <tr class=banaan>
      <td></td>
       <td> banaan </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
   <tr class=rode kool>
      <td></td>
       <td> rode kool </td>
       <td> <input type="number" value=0>  st </td>
   </tr>
   
   <tr class=winterpeen>
      <td></td>
       <td> winterpeen </td>
       <td> <input type="number" value=0>  kg </td>
   </tr>
   
  
   <tr> <th>koeling kruiden</th></tr>
   
   <tr class=tijm>
      <td></td>
       <td> tijm </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=peterselie>
      <td></td>
       <td> peterselie </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=bieslook>
      <td></td>
       <td> bieslook </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=mint>
      <td></td>
       <td> mint </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=lente ui>
      <td></td>
       <td> lente ui </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
   <tr class=tuinkers>
      <td></td>
       <td> tuinkers </td>
       <td> <input type="number" value=0>  bakje </td>
   </tr>
   
   <tr class=koriander>
      <td></td>
       <td> koriander </td>
       <td> <input type="number" value=0>  bos </td>
   </tr>
   
  
  </tbody>
</table>



<h3>Bestellijst / Netto nodig</h3>
<table id="bestellijst">
  <thead>
    <tr>
      <th>Ingredient</th>
      <th>Hoeveelheid</th>
    </tr>
  </thead>
  <tbody>
  
   <tr class=citroen>
       <td> citroen </td>
       <td> <input id=citroen value=0 readonly>  kg </td>
   </tr>
  
   <tr class=gember>
       <td> gember </td>
       <td> <input id=gember value=0 readonly>  kg </td>
   </tr>
  
   <tr class=komkommer>
       <td> komkommer </td>
       <td> <input id=komkommer value=0 readonly>  st </td>
   </tr>
  
   <tr class=sinaasappel>
       <td> sinaasappel </td>
       <td> <input id=sinaasappel value=0 readonly>  kg </td>
   </tr>
  
   <tr class=koriander>
       <td> koriander </td>
       <td> <input id=koriander value=0 readonly>  bos </td>
   </tr>
  
   <tr class=lente ui>
       <td> lente ui </td>
       <td> <input id=lente ui value=0 readonly>  bos </td>
   </tr>
  
   <tr class=sla>
       <td> sla </td>
       <td> <input id=sla value=0 readonly>  bos </td>
   </tr>
  
   <tr class=tomaat>
       <td> tomaat </td>
       <td> <input id=tomaat value=0 readonly>  kg </td>
   </tr>
  
   <tr class=peterselie>
       <td> peterselie </td>
       <td> <input id=peterselie value=0 readonly>  bos </td>
   </tr>
  
   <tr class=aardappel>
       <td> aardappel </td>
       <td> <input id=aardappel value=0 readonly>  kg </td>
   </tr>
  
   <tr class=knoflook>
       <td> knoflook </td>
       <td> <input id=knoflook value=0 readonly>  kg </td>
   </tr>
  
   <tr class=rode ui>
       <td> rode ui </td>
       <td> <input id=rode ui value=0 readonly>  kg </td>
   </tr>
  
   <tr class=bieslook>
       <td> bieslook </td>
       <td> <input id=bieslook value=0 readonly>  bos </td>
   </tr>
  
   <tr class=bloemkool>
       <td> bloemkool </td>
       <td> <input id=bloemkool value=0 readonly>  st </td>
   </tr>
  
   <tr class=banaan>
       <td> banaan </td>
       <td> <input id=banaan value=0 readonly>  kg </td>
   </tr>
  
   <tr class=aubergine>
       <td> aubergine </td>
       <td> <input id=aubergine value=0 readonly>  kg </td>
   </tr>
  
   <tr class=rucola>
       <td> rucola </td>
       <td> <input id=rucola value=0 readonly>  bakje </td>
   </tr>
  
   <tr class=oesterzwam>
       <td> oesterzwam </td>
       <td> <input id=oesterzwam value=0 readonly>  kg </td>
   </tr>
  
   <tr class=ui>
       <td> ui </td>
       <td> <input id=ui value=0 readonly>  kg </td>
   </tr>
  
   <tr class=sjalot>
       <td> sjalot </td>
       <td> <input id=sjalot value=0 readonly>  kg </td>
   </tr>
  
   <tr class=wortel>
       <td> wortel </td>
       <td> <input id=wortel value=0 readonly>  bos </td>
   </tr>
  
   <tr class=knolselderij>
       <td> knolselderij </td>
       <td> <input id=knolselderij value=0 readonly>  st </td>
   </tr>
  
   <tr class=tijm>
       <td> tijm </td>
       <td> <input id=tijm value=0 readonly>  bos </td>
   </tr>
  
   <tr class=peer>
       <td> peer </td>
       <td> <input id=peer value=0 readonly>  kg </td>
   </tr>
  
   <tr class=paprika>
       <td> paprika </td>
       <td> <input id=paprika value=0 readonly>  kg </td>
   </tr>
  
   <tr class=mandarijn>
       <td> mandarijn </td>
       <td> <input id=mandarijn value=0 readonly>  kg </td>
   </tr>
  
   <tr class=winterpeen>
       <td> winterpeen </td>
       <td> <input id=winterpeen value=0 readonly>  kg </td>
   </tr>
  
   <tr class=granaatappel>
       <td> granaatappel </td>
       <td> <input id=granaatappel value=0 readonly>  st </td>
   </tr>
  
   <tr class=rode kool>
       <td> rode kool </td>
       <td> <input id=rode kool value=0 readonly>  st </td>
   </tr>
  
   <tr class=champignon>
       <td> champignon </td>
       <td> <input id=champignon value=0 readonly>  kg </td>
   </tr>
  
   <tr class=pruim>
       <td> pruim </td>
       <td> <input id=pruim value=0 readonly>  kg </td>
   </tr>
  
   <tr class=rode peper>
       <td> rode peper </td>
       <td> <input id=rode peper value=0 readonly>  kg </td>
   </tr>
  
   <tr class=limoen>
       <td> limoen </td>
       <td> <input id=limoen value=0 readonly>  kg </td>
   </tr>
  
   <tr class=tuinkers>
       <td> tuinkers </td>
       <td> <input id=tuinkers value=0 readonly>  bakje </td>
   </tr>
  
   <tr class=mint>
       <td> mint </td>
       <td> <input id=mint value=0 readonly>  bos </td>
   </tr>
  
  </tbody>
</table>

</div>



<script>
// Service worker stuff
if ('serviceWorker' in navigator) {
  // Try to register the service worker.
  console.log("hi")
  try {
    console.log("again")
    // Capture the registration for later use, if needed
    let reg = navigator.serviceWorker.register('/service-worker.js');
    console.log('Service worker registered! 😎', reg);
  } catch (err) {
    console.log('😥 Service worker registration failed: ', err);
  }
} else {
  console.log("No 'serviceWorker' in navigator");
}



var recipes = {"amuse": [["champignon", 0.2], ["sjalot", 0.1], ["knoflook", 0.01]], "aubergine tempura": [["aubergine", 4.0]], "aubergine": [["aubergine", 1.5]], "bananenbrood": [["banaan", 0.75]], "bediening": [["citroen", 2.0], ["gember", 1.0], ["komkommer", 1.5], ["limoen", 0.7], ["mint", 5.0], ["sinaasappel", 1.0]], "champignons": [["champignon", 2.5], ["ui", 1.0], ["knoflook", 0.05]], "feta": [["citroen", 0.1]], "friet": [["aardappel", 6.0]], "garnering": [["koriander", 1.5], ["lente ui", 2.0], ["sla", 1.0], ["tomaat", 1.0], ["komkommer", 2.0], ["peterselie", 1.0], ["granaatappel", 1.0], ["tuinkers", 1.0], ["rucola", 1.0]], "gekarameliseerde ui": [["ui", 2.0]], "harissa": [["rode peper", 0.2]], "jackfruit": [["rode ui", 0.25], ["knoflook", 0.008]], "kashke": [["aubergine", 6.5], ["knoflook", 0.1]], "knolselderij": [["knolselderij", 0.5]], "koolsla": [["rode kool", 0.5], ["winterpeen", 0.2], ["ui", 0.1], ["limoen", 0.1], ["bieslook", 0.5]], "kruidenboter": [["peterselie", 0.5], ["bieslook", 0.5]], "nuggets": [["bloemkool", 6.0]], "oesterzwam": [["oesterzwam", 1.5], ["knoflook", 0.05]], "pastei": [["tijm", 0.5], ["peer", 1.5]], "peterselieboter": [["peterselie", 0.5], ["knoflook", 0.05]], "pruimenglaze": [["pruim", 1.5], ["rode peper", 0.1]], "salsa": [["knoflook", 0.01], ["koriander", 0.5], ["rode ui", 0.4]], "shakshuka": [["paprika", 5.0], ["ui", 2.0], ["knoflook", 0.1]], "sjalot": [["sjalot", 1.2]], "tiramisu": [["mandarijn", 0.2]], "topping": [["rode ui", 0.2]], "wortel": [["wortel", 4.0]]};

var mep = document.getElementById("mep");
var voorraad = document.getElementById("voorraad");
var bestellijst = document.getElementById("bestellijst");

// Update the order list on every change
function update_bestellijst() {

  var needed_ingredients = {}

  // Add ingredients of all recipes
  for (var row of mep.getElementsByTagName("tr")) {

    var recipe_name = row.getAttribute('class');
    if (recipe_name == null) continue;

    var recipe_count = row.getElementsByTagName("input")[0].value;
    if (recipe_count == '' || recipe_count < 0) {
      recipe_count = 0;
      row.getElementsByTagName("input")[0].value = recipe_count;
    }

    for (var [ingredient, amount] of recipes[recipe_name]) {
      if (ingredient in needed_ingredients) {
        needed_ingredients[ingredient] += amount * recipe_count;
      } else {
        needed_ingredients[ingredient] = amount * recipe_count;
      }
    }
  }

  console.log(needed_ingredients);

  // Subtract ingredients in the inventory
  for (var row of voorraad.getElementsByTagName("tr")) {

    var ingredient = row.getAttribute('class');
    if (ingredient == null) continue;

    // Hide and skip unnecessary stuff
    if (needed_ingredients[ingredient] == 0 || !(ingredient in needed_ingredients)) {
      row.style.opacity = "50%";
      row.getElementsByTagName("input")[0].setAttribute("disabled", "");
      continue;
    } else {
      row.style.opacity = "100%";
      row.getElementsByTagName("input")[0].removeAttribute("disabled");
    }

    var ingredient_count = row.getElementsByTagName("input")[0].value;
    if (ingredient_count == '' || ingredient_count <= 0) {
      ingredient_count = 0;
      row.getElementsByTagName("input")[0].value = ingredient_count;
    } else {
      needed_ingredients[ingredient] -= ingredient_count;
    }
  }

  // Show final order list
  // TODO: in the right order
  for (var row of bestellijst.getElementsByTagName("tr")) {
    var ingredient = row.getAttribute('class');
    if (ingredient == null) continue;

    // Hide or skip unnecessary stuff
    if (!(ingredient in needed_ingredients)) {
      row.style.opacity = "50%";
      row.getElementsByTagName("input")[0].value = 0;
      continue;
    }

    if (needed_ingredients[ingredient] <= 0) {
      row.style.opacity = "50%";
    } else {
      row.style.opacity = "100%";
    }

    row.getElementsByTagName("input")[0].value = needed_ingredients[ingredient];
  }

}

mep.addEventListener('change', update_bestellijst);
voorraad.addEventListener('change', update_bestellijst);

</script>




</body>
</html>